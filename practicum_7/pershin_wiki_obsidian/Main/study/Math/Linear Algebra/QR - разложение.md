---
id: Untitled
created_date: 27/04/2024
updated_date: 27/04/2024
tags:
  - Theory
  - math
parent: "[[Разложение матриц]]"
Тема: Теория
type: theme note
---

> [! NOTE] Определение
> Поставим теперь следующую задачу: *ортогональными преобразованиями* привести матрицу $A$ к [[треугольная матрица| треугольному]] виду. Иначе, осуществить *разложение* матрицы $A$, т.е. описать процедуру, посредством которой получается равенство 
> $$A = QR$$
> где $Q$ - [[Ортогональная матрица| ортогональная]] матрица ($Q^{-1} = Q^T$), а $R$ - [[треугольная матрица | верхне треугольная]]
> $Q$ получается с помощью [[Алгоритм Грама-Шмидта | Алгоритма Грама-Шмидта]]
> $Q$ - матрица поворота
> $R$ - матрица сдвига 

## Основная часть

### Теорема [о QR-разложении]
 Для любой вещественной матрицы $A_{m×n}$ ранга $n<m$ _существует вещественная матрица_ $Q_{m×n}$ _c ортонормированными столбцами и верхнетреугольная вещественная матрица_ $R_{n*n}$, _такие, что_
 $$A = QR$$

#### Как найти $Q,R$?

*Дано*: $A$ - наша матрица
*Найти*: $Q$ - ортогональная матрица, $R$ - верхне треугольная, такие, что $$A = QR$$
1) Запишем $A=\{a_{1},a_{2},\ldots,a_{n}\}$, где $a_i$ - вектор-столбец
2) "Прогоним" каждый $a_i$ через [[Алгоритм Грама-Шмидта]]
3) Получим $G=\{g_{1},g_{2},\ldots,g_{n}\}$, где $\vec{g}_{i}\perp\vec{g}_{k}\quad\forall_{i,k}$
4) Нормируем $G$ и получим $Q=\{q_{1},q_{2}\ldots,q_{n}\}$, где $q_{i}=\frac{g_{i}}{||g_{i}||}$
5) Теперь запишем $A = QB$, где $B$ - какая-то остаточная матрица
6) Найдем $B$: $Q^{-1}A = B$, перепишем в $Q^{T}A = B$
7) Докажем, что $B = R$:
	1) Пусть $k=1\ldots m$
	2)  $a_{k}=\sum_{j=1}^{m}\lambda_{j}q_{i},$  где $\lambda_{i}\in R$
	3) Следовательно $q_{m+1} \perp a_k$, тк $a_k$ не содержит в своей линейной комбинации $q_{m+1}$
	4)  Следовательно *$\forall j>i:\overline{a}_{i}\bot\overline{q}_{j}$*
	5) тк $B=Q^{T}A=\{\begin{matrix}q_{1}\\q_{2}\\q_{n}\end{matrix}\}\{a_{1}\ldots a_{n}\}= \{b_{ij}=\overline{q_{i}}\cdot\overline{a_{j}}\}=\{b_{ij}|i>j\Rightarrow b_{ij}=0\}$
	6) Следовательно $B = R$ - [[треугольная матрица | верхне треугольная матрица]]
#### Пример

$$\left( 
\begin{array}{ccc} 1 & 1 & 1 \\ 
0 & 1 & 1 \\
0 & 0 & 1 \\
0 & 1 & 1 \\
1 & 1 & 1 
\end{array} \right) = \left( 
\begin{array}{ccc}  
1/\sqrt{2} & 0 & 0 \\
0 & 1/\sqrt{2}  & 0 \\
0 & 0 & 1 \\
0 & 1/\sqrt{2}  & 0 \\
1/\sqrt{2} & 0 & 0 
\end{array} \right) \left\{ 
\left( 
\begin{array}{rrr}  
1 & -1 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1 
\end{array} \right)
\left( 
\begin{array}{rrr}  
1 & 0 & -1 \\
0 & 1 & -1 \\
0 & 0 & 1 
\end{array} \right)
\left( 
\begin{array}{ccc}  
1/\sqrt{2} & 0 & 0 \\
0 & 1/\sqrt{2}  & 0 \\
0 & 0 & 1 
\end{array} \right)
\right\}^{-1} = \left( 
\begin{array}{ccc}  
1/\sqrt{2} & 0 & 0 \\
0 & 1/\sqrt{2}  & 0 \\
0 & 0 & 1 \\
0 & 1/\sqrt{2}  & 0 \\
1/\sqrt{2} & 0 & 0 
\end{array} \right)\left( 
\begin{array}{rrr}  
\sqrt{2} & \sqrt{2} & \sqrt{2} \\
0 & \sqrt{2} & \sqrt{2} \\
0 & 0 & 1 
\end{array} \right) 
\,$$
> ❗️Для квадратной [[Базовые Виды Матриц#Вырожденная/невырожденная| неособенной]] вещественной матрицы A матрица Q в **QR**-разложении будет [[Ортогональная матрица| ортогональной]].

## Напрямую связано с [[QR - алгоритм | QR - алгоритмом]]
## Ссылки
- ❗️❗️❗️ https://www.youtube.com/watch?v=TuwAVjmZj4w
- http://vmath.ru/vf5/euclid_space#matrichnyj_formalizm_algoritma_grama-shmidtaqr-razlozhenie
- [голуб книга 195 стр](голуб_матричные_вычисления.pdf#page=195)
- [algowiki](<https://algowiki-project.org/ru/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%A5%D0%B0%D1%83%D1%81%D1%85%D0%BE%D0%BB%D0%B4%D0%B5%D1%80%D0%B0_(%D0%BE%D1%82%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9)_QR-%D1%80%D0%B0%D0%B7%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F_%D0%BA%D0%B2%D0%B0%D0%B4%D1%80%D0%B0%D1%82%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D1%8B,_%D0%B2%D0%B5%D1%89%D0%B5%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9_%D1%82%D0%BE%D1%87%D0%B5%D1%87%D0%BD%D1%8B%D0%B9_%D0%B2%D0%B0%D1%80%D0%B8%D0%B0%D0%BD%D1%82>)
- https://studfile.net/preview/10085122/ 

## Видео
